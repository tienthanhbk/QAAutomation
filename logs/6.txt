Train on 7551 samples, validate on 1803 samples
Epoch 1/100
7551/7551 [==============================] - 90s 12ms/step - loss: 1.0782 - val_loss: 0.7217
val MRR 0.313861; val MAP 0.151982

Epoch 00001: map improved from -inf to 0.15198, saving model to model_CuDNNimprovement-01-0.15.h5
Epoch 2/100
7551/7551 [==============================] - 85s 11ms/step - loss: 1.0041 - val_loss: 0.6774
val MRR 0.317416; val MAP 0.153570

Epoch 00002: map improved from 0.15198 to 0.15357, saving model to model_CuDNNimprovement-02-0.15.h5
Epoch 3/100
7551/7551 [==============================] - 85s 11ms/step - loss: 0.9406 - val_loss: 0.6430
val MRR 0.322187; val MAP 0.153781

Epoch 00003: map improved from 0.15357 to 0.15378, saving model to model_CuDNNimprovement-03-0.15.h5
Epoch 4/100
7551/7551 [==============================] - 84s 11ms/step - loss: 0.8934 - val_loss: 0.6148
val MRR 0.293922; val MAP 0.152739

Epoch 00004: map did not improve from 0.15378
Epoch 5/100
7551/7551 [==============================] - 85s 11ms/step - loss: 0.8573 - val_loss: 0.5880
val MRR 0.276450; val MAP 0.155269

Epoch 00005: map improved from 0.15378 to 0.15527, saving model to model_CuDNNimprovement-05-0.16.h5
Epoch 6/100
7551/7551 [==============================] - 88s 12ms/step - loss: 0.8181 - val_loss: 0.5723
val MRR 0.285467; val MAP 0.157413

Epoch 00006: map improved from 0.15527 to 0.15741, saving model to model_CuDNNimprovement-06-0.16.h5
Epoch 7/100
7551/7551 [==============================] - 88s 12ms/step - loss: 0.7914 - val_loss: 0.5553
val MRR 0.289792; val MAP 0.158511

Epoch 00007: map improved from 0.15741 to 0.15851, saving model to model_CuDNNimprovement-07-0.16.h5
Epoch 8/100
7551/7551 [==============================] - 86s 11ms/step - loss: 0.7470 - val_loss: 0.5429
val MRR 0.304569; val MAP 0.161151

Epoch 00008: map improved from 0.15851 to 0.16115, saving model to model_CuDNNimprovement-08-0.16.h5
Epoch 9/100
7551/7551 [==============================] - 88s 12ms/step - loss: 0.7321 - val_loss: 0.5315
val MRR 0.302917; val MAP 0.162462

Epoch 00009: map improved from 0.16115 to 0.16246, saving model to model_CuDNNimprovement-09-0.16.h5
Epoch 10/100
7551/7551 [==============================] - 89s 12ms/step - loss: 0.7323 - val_loss: 0.5265
val MRR 0.300357; val MAP 0.164571

Epoch 00010: map improved from 0.16246 to 0.16457, saving model to model_CuDNNimprovement-10-0.16.h5
Epoch 11/100
7551/7551 [==============================] - 89s 12ms/step - loss: 0.6938 - val_loss: 0.5236
val MRR 0.285618; val MAP 0.165489

Epoch 00011: map improved from 0.16457 to 0.16549, saving model to model_CuDNNimprovement-11-0.17.h5
Epoch 12/100
7551/7551 [==============================] - 88s 12ms/step - loss: 0.6949 - val_loss: 0.5203
val MRR 0.295914; val MAP 0.166425

Epoch 00012: map improved from 0.16549 to 0.16643, saving model to model_CuDNNimprovement-12-0.17.h5
Epoch 13/100
7551/7551 [==============================] - 88s 12ms/step - loss: 0.6897 - val_loss: 0.5183
val MRR 0.298498; val MAP 0.168637

Epoch 00013: map improved from 0.16643 to 0.16864, saving model to model_CuDNNimprovement-13-0.17.h5
Epoch 14/100
7551/7551 [==============================] - 84s 11ms/step - loss: 0.6634 - val_loss: 0.5161
val MRR 0.367888; val MAP 0.175922

Epoch 00014: map improved from 0.16864 to 0.17592, saving model to model_CuDNNimprovement-14-0.18.h5
Epoch 15/100
7551/7551 [==============================] - 84s 11ms/step - loss: 0.6447 - val_loss: 0.5166
val MRR 0.239401; val MAP 0.173451

Epoch 00015: map did not improve from 0.17592
Epoch 16/100
7551/7551 [==============================] - 84s 11ms/step - loss: 0.6550 - val_loss: 0.5178
val MRR 0.241163; val MAP 0.176177

Epoch 00016: map improved from 0.17592 to 0.17618, saving model to model_CuDNNimprovement-16-0.18.h5
Epoch 17/100
7551/7551 [==============================] - 84s 11ms/step - loss: 0.6452 - val_loss: 0.5198
val MRR 0.244857; val MAP 0.175627

Epoch 00017: map did not improve from 0.17618
Epoch 18/100
7551/7551 [==============================] - 86s 11ms/step - loss: 0.6158 - val_loss: 0.5200
val MRR 0.247350; val MAP 0.177558

Epoch 00018: map improved from 0.17618 to 0.17756, saving model to model_CuDNNimprovement-18-0.18.h5
Epoch 19/100
7551/7551 [==============================] - 85s 11ms/step - loss: 0.6272 - val_loss: 0.5227
val MRR 0.298196; val MAP 0.180152

Epoch 00019: map improved from 0.17756 to 0.18015, saving model to model_CuDNNimprovement-19-0.18.h5
Epoch 20/100
7551/7551 [==============================] - 86s 11ms/step - loss: 0.6252 - val_loss: 0.5217
val MRR 0.295444; val MAP 0.181267

Epoch 00020: map improved from 0.18015 to 0.18127, saving model to model_CuDNNimprovement-20-0.18.h5
Epoch 21/100
7551/7551 [==============================] - 86s 11ms/step - loss: 0.6121 - val_loss: 0.5225
val MRR 0.309102; val MAP 0.182957

Epoch 00021: map improved from 0.18127 to 0.18296, saving model to model_CuDNNimprovement-21-0.18.h5
Epoch 22/100
7551/7551 [==============================] - 87s 12ms/step - loss: 0.5959 - val_loss: 0.5243
val MRR 0.308899; val MAP 0.183373

Epoch 00022: map improved from 0.18296 to 0.18337, saving model to model_CuDNNimprovement-22-0.18.h5
Epoch 23/100
7551/7551 [==============================] - 87s 12ms/step - loss: 0.5827 - val_loss: 0.5251
val MRR 0.331166; val MAP 0.185601

Epoch 00023: map improved from 0.18337 to 0.18560, saving model to model_CuDNNimprovement-23-0.19.h5
Epoch 24/100
7551/7551 [==============================] - 88s 12ms/step - loss: 0.5951 - val_loss: 0.5284
val MRR 0.333114; val MAP 0.188411

Epoch 00024: map improved from 0.18560 to 0.18841, saving model to model_CuDNNimprovement-24-0.19.h5
Epoch 25/100
7551/7551 [==============================] - 90s 12ms/step - loss: 0.5674 - val_loss: 0.5307
val MRR 0.337972; val MAP 0.192899

Epoch 00025: map improved from 0.18841 to 0.19290, saving model to model_CuDNNimprovement-25-0.19.h5
Epoch 26/100
7551/7551 [==============================] - 89s 12ms/step - loss: 0.5710 - val_loss: 0.5356
val MRR 0.336289; val MAP 0.193045

Epoch 00026: map improved from 0.19290 to 0.19305, saving model to model_CuDNNimprovement-26-0.19.h5
Epoch 27/100
7551/7551 [==============================] - 89s 12ms/step - loss: 0.5657 - val_loss: 0.5408
val MRR 0.331364; val MAP 0.192118

Epoch 00027: map did not improve from 0.19305
Epoch 28/100
7551/7551 [==============================] - 89s 12ms/step - loss: 0.5562 - val_loss: 0.5445
val MRR 0.331427; val MAP 0.193911

Epoch 00028: map improved from 0.19305 to 0.19391, saving model to model_CuDNNimprovement-28-0.19.h5
Epoch 29/100
7551/7551 [==============================] - 86s 11ms/step - loss: 0.5451 - val_loss: 0.5514
val MRR 0.266300; val MAP 0.193495

Epoch 00029: map did not improve from 0.19391
Epoch 30/100
7551/7551 [==============================] - 84s 11ms/step - loss: 0.5476 - val_loss: 0.5569
val MRR 0.261850; val MAP 0.192609

Epoch 00030: map did not improve from 0.19391
Epoch 31/100
7551/7551 [==============================] - 83s 11ms/step - loss: 0.5441 - val_loss: 0.5622
val MRR 0.276713; val MAP 0.192719

Epoch 00031: map did not improve from 0.19391
Epoch 32/100
7551/7551 [==============================] - 84s 11ms/step - loss: 0.5348 - val_loss: 0.5696
val MRR 0.263514; val MAP 0.194305

Epoch 00032: map improved from 0.19391 to 0.19430, saving model to model_CuDNNimprovement-32-0.19.h5
Epoch 33/100
7551/7551 [==============================] - 84s 11ms/step - loss: 0.5506 - val_loss: 0.5750
val MRR 0.248900; val MAP 0.195320

Epoch 00033: map improved from 0.19430 to 0.19532, saving model to model_CuDNNimprovement-33-0.20.h5
Epoch 34/100
7551/7551 [==============================] - 82s 11ms/step - loss: 0.5348 - val_loss: 0.5803
val MRR 0.244704; val MAP 0.194655

Epoch 00034: map did not improve from 0.19532
Epoch 35/100
7551/7551 [==============================] - 84s 11ms/step - loss: 0.5342 - val_loss: 0.5850
val MRR 0.245818; val MAP 0.196990

Epoch 00035: map improved from 0.19532 to 0.19699, saving model to model_CuDNNimprovement-35-0.20.h5
Epoch 36/100
7551/7551 [==============================] - 84s 11ms/step - loss: 0.5184 - val_loss: 0.5887
val MRR 0.249364; val MAP 0.199524

Epoch 00036: map improved from 0.19699 to 0.19952, saving model to model_CuDNNimprovement-36-0.20.h5
Epoch 37/100
7551/7551 [==============================] - 86s 11ms/step - loss: 0.5240 - val_loss: 0.5952
val MRR 0.246056; val MAP 0.198703

Epoch 00037: map did not improve from 0.19952
Epoch 38/100
7551/7551 [==============================] - 85s 11ms/step - loss: 0.5024 - val_loss: 0.5992
val MRR 0.242896; val MAP 0.199522

Epoch 00038: map did not improve from 0.19952
Epoch 39/100
7551/7551 [==============================] - 86s 11ms/step - loss: 0.5001 - val_loss: 0.6000
val MRR 0.241729; val MAP 0.198665

Epoch 00039: map did not improve from 0.19952
Epoch 40/100
7551/7551 [==============================] - 87s 11ms/step - loss: 0.5115 - val_loss: 0.6099
val MRR 0.241166; val MAP 0.199703

Epoch 00040: map improved from 0.19952 to 0.19970, saving model to model_CuDNNimprovement-40-0.20.h5
Epoch 41/100
7551/7551 [==============================] - 87s 11ms/step - loss: 0.5067 - val_loss: 0.6174
val MRR 0.240726; val MAP 0.200386

Epoch 00041: map improved from 0.19970 to 0.20039, saving model to model_CuDNNimprovement-41-0.20.h5
Epoch 42/100
7551/7551 [==============================] - 89s 12ms/step - loss: 0.5048 - val_loss: 0.6222
val MRR 0.242603; val MAP 0.201103

Epoch 00042: map improved from 0.20039 to 0.20110, saving model to model_CuDNNimprovement-42-0.20.h5
Epoch 43/100
7551/7551 [==============================] - 88s 12ms/step - loss: 0.4956 - val_loss: 0.6359
val MRR 0.239062; val MAP 0.200253

Epoch 00043: map did not improve from 0.20110
Epoch 44/100
7551/7551 [==============================] - 90s 12ms/step - loss: 0.4940 - val_loss: 0.6457
val MRR 0.220399; val MAP 0.199311

Epoch 00044: map did not improve from 0.20110
Epoch 45/100
7551/7551 [==============================] - 89s 12ms/step - loss: 0.4746 - val_loss: 0.6500
val MRR 0.217995; val MAP 0.199802

Epoch 00045: map did not improve from 0.20110
Epoch 46/100
7551/7551 [==============================] - 89s 12ms/step - loss: 0.4922 - val_loss: 0.6598
val MRR 0.210960; val MAP 0.199890

Epoch 00046: map did not improve from 0.20110
Epoch 47/100
7551/7551 [==============================] - 88s 12ms/step - loss: 0.4871 - val_loss: 0.6669
val MRR 0.203630; val MAP 0.200917

Epoch 00047: map did not improve from 0.20110
Epoch 48/100
7551/7551 [==============================] - 85s 11ms/step - loss: 0.4784 - val_loss: 0.6749
val MRR 0.203630; val MAP 0.201258

Epoch 00048: map improved from 0.20110 to 0.20126, saving model to model_CuDNNimprovement-48-0.20.h5
Epoch 49/100
7551/7551 [==============================] - 83s 11ms/step - loss: 0.4594 - val_loss: 0.6843
val MRR 0.203692; val MAP 0.201458

Epoch 00049: map improved from 0.20126 to 0.20146, saving model to model_CuDNNimprovement-49-0.20.h5
Epoch 50/100
7551/7551 [==============================] - 84s 11ms/step - loss: 0.4543 - val_loss: 0.6954
val MRR 0.201658; val MAP 0.201548

Epoch 00050: map improved from 0.20146 to 0.20155, saving model to model_CuDNNimprovement-50-0.20.h5
Epoch 51/100
7551/7551 [==============================] - 84s 11ms/step - loss: 0.4584 - val_loss: 0.7034
val MRR 0.201135; val MAP 0.201527

Epoch 00051: map did not improve from 0.20155
Epoch 52/100
7551/7551 [==============================] - 85s 11ms/step - loss: 0.4681 - val_loss: 0.7005
val MRR 0.197613; val MAP 0.200582

Epoch 00052: map did not improve from 0.20155
Epoch 53/100
7551/7551 [==============================] - 85s 11ms/step - loss: 0.4646 - val_loss: 0.6982
val MRR 0.199185; val MAP 0.202051

Epoch 00053: map improved from 0.20155 to 0.20205, saving model to model_CuDNNimprovement-53-0.20.h5
Epoch 54/100
7551/7551 [==============================] - 84s 11ms/step - loss: 0.4532 - val_loss: 0.7043
val MRR 0.200385; val MAP 0.202753

Epoch 00054: map improved from 0.20205 to 0.20275, saving model to model_CuDNNimprovement-54-0.20.h5
Epoch 55/100
7551/7551 [==============================] - 85s 11ms/step - loss: 0.4557 - val_loss: 0.7130
val MRR 0.200698; val MAP 0.203726

Epoch 00055: map improved from 0.20275 to 0.20373, saving model to model_CuDNNimprovement-55-0.20.h5
Epoch 56/100
7551/7551 [==============================] - 85s 11ms/step - loss: 0.4491 - val_loss: 0.7074
val MRR 0.203409; val MAP 0.203117

Epoch 00056: map did not improve from 0.20373
Epoch 57/100
7551/7551 [==============================] - 85s 11ms/step - loss: 0.4503 - val_loss: 0.7106
val MRR 0.202263; val MAP 0.202856

Epoch 00057: map did not improve from 0.20373
Epoch 58/100
7551/7551 [==============================] - 86s 11ms/step - loss: 0.4435 - val_loss: 0.7140
val MRR 0.269807; val MAP 0.204775

Epoch 00058: map improved from 0.20373 to 0.20477, saving model to model_CuDNNimprovement-58-0.20.h5
Epoch 59/100
7551/7551 [==============================] - 90s 12ms/step - loss: 0.4541 - val_loss: 0.7158
val MRR 0.271035; val MAP 0.205177

Epoch 00059: map improved from 0.20477 to 0.20518, saving model to model_CuDNNimprovement-59-0.21.h5
Epoch 60/100
7551/7551 [==============================] - 88s 12ms/step - loss: 0.4533 - val_loss: 0.7205
val MRR 0.272318; val MAP 0.205808

Epoch 00060: map improved from 0.20518 to 0.20581, saving model to model_CuDNNimprovement-60-0.21.h5
Epoch 61/100
7551/7551 [==============================] - 89s 12ms/step - loss: 0.4464 - val_loss: 0.7272
val MRR 0.275415; val MAP 0.206683

Epoch 00061: map improved from 0.20581 to 0.20668, saving model to model_CuDNNimprovement-61-0.21.h5
Epoch 62/100
7551/7551 [==============================] - 89s 12ms/step - loss: 0.4512 - val_loss: 0.7205
val MRR 0.272241; val MAP 0.207543

Epoch 00062: map improved from 0.20668 to 0.20754, saving model to model_CuDNNimprovement-62-0.21.h5
Epoch 63/100
7551/7551 [==============================] - 90s 12ms/step - loss: 0.4436 - val_loss: 0.7208
val MRR 0.277563; val MAP 0.207703

Epoch 00063: map improved from 0.20754 to 0.20770, saving model to model_CuDNNimprovement-63-0.21.h5
Epoch 64/100
7551/7551 [==============================] - 89s 12ms/step - loss: 0.4430 - val_loss: 0.7292
val MRR 0.274204; val MAP 0.207681

Epoch 00064: map did not improve from 0.20770
Epoch 65/100
7551/7551 [==============================] - 88s 12ms/step - loss: 0.4411 - val_loss: 0.7298
val MRR 0.273154; val MAP 0.207483

Epoch 00065: map did not improve from 0.20770
Epoch 66/100
7551/7551 [==============================] - 84s 11ms/step - loss: 0.4376 - val_loss: 0.7341
val MRR 0.274687; val MAP 0.209071

Epoch 00066: map improved from 0.20770 to 0.20907, saving model to model_CuDNNimprovement-66-0.21.h5
Epoch 67/100
7551/7551 [==============================] - 84s 11ms/step - loss: 0.4351 - val_loss: 0.7346
val MRR 0.277753; val MAP 0.208949

Epoch 00067: map did not improve from 0.20907
Epoch 68/100
7551/7551 [==============================] - 83s 11ms/step - loss: 0.4276 - val_loss: 0.7269
val MRR 0.275556; val MAP 0.207920

Epoch 00068: map did not improve from 0.20907
Epoch 69/100
7551/7551 [==============================] - 84s 11ms/step - loss: 0.4278 - val_loss: 0.7281
val MRR 0.277817; val MAP 0.208844

Epoch 00069: map did not improve from 0.20907
Epoch 70/100
7551/7551 [==============================] - 85s 11ms/step - loss: 0.4309 - val_loss: 0.7281
val MRR 0.274544; val MAP 0.208305

Epoch 00070: map did not improve from 0.20907
Epoch 71/100
7551/7551 [==============================] - 85s 11ms/step - loss: 0.4278 - val_loss: 0.7327
val MRR 0.276713; val MAP 0.207774

Epoch 00071: map did not improve from 0.20907
Epoch 72/100
7551/7551 [==============================] - 86s 11ms/step - loss: 0.4210 - val_loss: 0.7334
val MRR 0.275911; val MAP 0.208155

Epoch 00072: map did not improve from 0.20907
Epoch 73/100
7551/7551 [==============================] - 85s 11ms/step - loss: 0.4228 - val_loss: 0.7278
val MRR 0.275292; val MAP 0.208344

Epoch 00073: map did not improve from 0.20907
Epoch 74/100
7551/7551 [==============================] - 86s 11ms/step - loss: 0.4235 - val_loss: 0.7268
val MRR 0.276291; val MAP 0.208065

Epoch 00074: map did not improve from 0.20907
Epoch 75/100
7551/7551 [==============================] - 86s 11ms/step - loss: 0.4167 - val_loss: 0.7242
val MRR 0.280255; val MAP 0.209434

Epoch 00075: map improved from 0.20907 to 0.20943, saving model to model_CuDNNimprovement-75-0.21.h5
Epoch 76/100
7551/7551 [==============================] - 86s 11ms/step - loss: 0.4203 - val_loss: 0.7193
val MRR 0.280575; val MAP 0.209424

Epoch 00076: map did not improve from 0.20943
Epoch 77/100
7551/7551 [==============================] - 89s 12ms/step - loss: 0.4120 - val_loss: 0.7247
val MRR 0.278528; val MAP 0.210105

Epoch 00077: map improved from 0.20943 to 0.21011, saving model to model_CuDNNimprovement-77-0.21.h5
Epoch 78/100
7551/7551 [==============================] - 88s 12ms/step - loss: 0.4142 - val_loss: 0.7366
val MRR 0.280116; val MAP 0.210002

Epoch 00078: map did not improve from 0.21011
Epoch 79/100
7551/7551 [==============================] - 89s 12ms/step - loss: 0.4168 - val_loss: 0.7286
val MRR 0.282497; val MAP 0.210545

Epoch 00079: map improved from 0.21011 to 0.21055, saving model to model_CuDNNimprovement-79-0.21.h5
Epoch 80/100
7551/7551 [==============================] - 88s 12ms/step - loss: 0.4113 - val_loss: 0.7292
val MRR 0.282121; val MAP 0.210464

Epoch 00080: map did not improve from 0.21055
Epoch 81/100
7551/7551 [==============================] - 89s 12ms/step - loss: 0.4062 - val_loss: 0.7290
val MRR 0.286968; val MAP 0.210273

Epoch 00081: map did not improve from 0.21055
Epoch 82/100
7551/7551 [==============================] - 87s 12ms/step - loss: 0.4173 - val_loss: 0.7282
val MRR 0.287081; val MAP 0.210707

Epoch 00082: map improved from 0.21055 to 0.21071, saving model to model_CuDNNimprovement-82-0.21.h5
Epoch 83/100
7551/7551 [==============================] - 88s 12ms/step - loss: 0.4031 - val_loss: 0.7345
val MRR 0.281927; val MAP 0.210521

Epoch 00083: map did not improve from 0.21071
Epoch 84/100
7551/7551 [==============================] - 85s 11ms/step - loss: 0.4076 - val_loss: 0.7336
val MRR 0.290081; val MAP 0.210720

Epoch 00084: map improved from 0.21071 to 0.21072, saving model to model_CuDNNimprovement-84-0.21.h5
Epoch 85/100
7551/7551 [==============================] - 84s 11ms/step - loss: 0.4083 - val_loss: 0.7301
val MRR 0.289926; val MAP 0.211136

Epoch 00085: map improved from 0.21072 to 0.21114, saving model to model_CuDNNimprovement-85-0.21.h5
Epoch 86/100
7551/7551 [==============================] - 84s 11ms/step - loss: 0.4058 - val_loss: 0.7249
val MRR 0.294658; val MAP 0.211047

Epoch 00086: map did not improve from 0.21114
Epoch 87/100
7551/7551 [==============================] - 84s 11ms/step - loss: 0.4048 - val_loss: 0.7159
val MRR 0.295081; val MAP 0.211035

Epoch 00087: map did not improve from 0.21114
Epoch 88/100
7551/7551 [==============================] - 84s 11ms/step - loss: 0.3943 - val_loss: 0.7108
val MRR 0.294733; val MAP 0.210854

Epoch 00088: map did not improve from 0.21114
Epoch 89/100
7551/7551 [==============================] - 86s 11ms/step - loss: 0.4013 - val_loss: 0.7050
val MRR 0.294159; val MAP 0.208525

Epoch 00089: map did not improve from 0.21114
Epoch 90/100
7551/7551 [==============================] - 86s 11ms/step - loss: 0.3986 - val_loss: 0.7050
val MRR 0.294075; val MAP 0.208805

Epoch 00090: map did not improve from 0.21114
Epoch 91/100
7551/7551 [==============================] - 85s 11ms/step - loss: 0.3946 - val_loss: 0.7034
val MRR 0.293940; val MAP 0.209305

Epoch 00091: map did not improve from 0.21114
Epoch 92/100
7551/7551 [==============================] - 86s 11ms/step - loss: 0.3871 - val_loss: 0.7010
val MRR 0.291548; val MAP 0.207789

Epoch 00092: map did not improve from 0.21114
Epoch 93/100
7551/7551 [==============================] - 87s 12ms/step - loss: 0.3999 - val_loss: 0.7175
val MRR 0.291548; val MAP 0.208163

Epoch 00093: map did not improve from 0.21114
Epoch 94/100
7551/7551 [==============================] - 87s 11ms/step - loss: 0.3997 - val_loss: 0.7131
val MRR 0.292457; val MAP 0.208539

Epoch 00094: map did not improve from 0.21114
Epoch 95/100
7551/7551 [==============================] - 87s 12ms/step - loss: 0.3943 - val_loss: 0.7142
val MRR 0.317404; val MAP 0.209227

Epoch 00095: map did not improve from 0.21114
Epoch 96/100
7551/7551 [==============================] - 90s 12ms/step - loss: 0.3888 - val_loss: 0.7063
val MRR 0.267457; val MAP 0.208987

Epoch 00096: map did not improve from 0.21114
Epoch 97/100
7551/7551 [==============================] - 89s 12ms/step - loss: 0.3942 - val_loss: 0.7095
val MRR 0.267349; val MAP 0.208493

Epoch 00097: map did not improve from 0.21114
Epoch 98/100
7551/7551 [==============================] - 90s 12ms/step - loss: 0.3876 - val_loss: 0.7153
val MRR 0.317304; val MAP 0.209337

Epoch 00098: map did not improve from 0.21114
Epoch 99/100
7551/7551 [==============================] - 89s 12ms/step - loss: 0.3896 - val_loss: 0.7041
val MRR 0.311983; val MAP 0.208320

Epoch 00099: map did not improve from 0.21114
Epoch 100/100
7551/7551 [==============================] - 88s 12ms/step - loss: 0.3899 - val_loss: 0.7104
val MRR 0.293000; val MAP 0.207100

Epoch 00100: map did not improve from 0.21114
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
question_base (InputLayer)      (None, 150)          0
__________________________________________________________________________________________________
answer (InputLayer)             (None, 150)          0
__________________________________________________________________________________________________
bi_lstm (Model)                 (None, 1)            2639729     question_base[0][0]
                                                                 answer[0][0]
==================================================================================================
Total params: 2,639,729
Trainable params: 2,638,129
Non-trainable params: 1,600

only question label 2 considered relevant

PATH_DATA_TRAIN = 'data/train.txt'
PATH_DATA_DEV = 'data/dev.txt'
PATH_DATA_TEST = 'data/test.txt'
PATH_WORD_VECTOR = 'data/lstm/vectors.txt'
PATH_VOCAB = 'data/lstm/vocab_all.txt'
wordvector_dims = 200

bi_lstm1 = Bidirectional(
        LSTM(units=200, return_sequences=False))
bi_lstm2 = Bidirectional(
    LSTM(units=200, return_sequences=False))

training_model.fit(
    [questions_origin, question_related],
    Y,
    epochs=100,
    batch_size=200,
    validation_data=([q_origin_dev_eb, q_related_dev_eb], l_dev),
    verbose=1,
    callbacks=callback_list
)

MAP:  0.27232330258276616
MRR:  0.5510204081632653