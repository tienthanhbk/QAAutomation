Epoch 1/100
7550/7550 [==============================] - 305s 40ms/step - loss: 1.1767 - val_loss: 0.7028
val MRR 0.357763; val MAP 0.260317

Epoch 00001: map improved from -inf to 0.26032, saving model to model_CuDNNimprovement-01-0.26.h5
Epoch 2/100
7550/7550 [==============================] - 298s 39ms/step - loss: 1.1274 - val_loss: 0.6885
val MRR 0.313168; val MAP 0.262851

Epoch 00002: map improved from 0.26032 to 0.26285, saving model to model_CuDNNimprovement-02-0.26.h5
Epoch 3/100
7550/7550 [==============================] - 302s 40ms/step - loss: 1.0451 - val_loss: 0.6824
val MRR 0.267778; val MAP 0.265358

Epoch 00003: map improved from 0.26285 to 0.26536, saving model to model_CuDNNimprovement-03-0.27.h5
Epoch 4/100
7550/7550 [==============================] - 297s 39ms/step - loss: 0.9970 - val_loss: 0.6839
val MRR 0.281667; val MAP 0.268140

Epoch 00004: map improved from 0.26536 to 0.26814, saving model to model_CuDNNimprovement-04-0.27.h5
Epoch 5/100
7550/7550 [==============================] - 302s 40ms/step - loss: 0.9409 - val_loss: 0.6825
val MRR 0.279622; val MAP 0.269505

Epoch 00005: map improved from 0.26814 to 0.26950, saving model to model_CuDNNimprovement-05-0.27.h5
Epoch 6/100
7550/7550 [==============================] - 287s 38ms/step - loss: 0.9248 - val_loss: 0.6853
val MRR 0.232960; val MAP 0.271306

Epoch 00006: map improved from 0.26950 to 0.27131, saving model to model_CuDNNimprovement-06-0.27.h5
Epoch 7/100
7550/7550 [==============================] - 288s 38ms/step - loss: 0.8977 - val_loss: 0.6867
val MRR 0.253970; val MAP 0.274601

Epoch 00007: map improved from 0.27131 to 0.27460, saving model to model_CuDNNimprovement-07-0.27.h5
Epoch 8/100
7550/7550 [==============================] - 296s 39ms/step - loss: 0.8759 - val_loss: 0.6836
val MRR 0.292743; val MAP 0.272144

Epoch 00008: map did not improve from 0.27460
Epoch 9/100
7550/7550 [==============================] - 297s 39ms/step - loss: 0.8512 - val_loss: 0.6831
val MRR 0.287200; val MAP 0.275414

Epoch 00009: map improved from 0.27460 to 0.27541, saving model to model_CuDNNimprovement-09-0.28.h5
Epoch 10/100
7550/7550 [==============================] - 292s 39ms/step - loss: 0.8158 - val_loss: 0.6797
val MRR 0.283322; val MAP 0.275531

Epoch 00010: map improved from 0.27541 to 0.27553, saving model to model_CuDNNimprovement-10-0.28.h5
Epoch 11/100
7550/7550 [==============================] - 297s 39ms/step - loss: 0.7939 - val_loss: 0.6753
val MRR 0.249952; val MAP 0.277622

Epoch 00011: map improved from 0.27553 to 0.27762, saving model to model_CuDNNimprovement-11-0.28.h5
Epoch 12/100
7550/7550 [==============================] - 295s 39ms/step - loss: 0.8020 - val_loss: 0.6755
val MRR 0.237395; val MAP 0.279708

Epoch 00012: map improved from 0.27762 to 0.27971, saving model to model_CuDNNimprovement-12-0.28.h5
Epoch 13/100
7550/7550 [==============================] - 291s 39ms/step - loss: 0.7840 - val_loss: 0.6772
val MRR 0.238596; val MAP 0.281609

Epoch 00013: map improved from 0.27971 to 0.28161, saving model to model_CuDNNimprovement-13-0.28.h5
Epoch 14/100
7550/7550 [==============================] - 286s 38ms/step - loss: 0.7701 - val_loss: 0.6792
val MRR 0.220692; val MAP 0.281837

Epoch 00014: map improved from 0.28161 to 0.28184, saving model to model_CuDNNimprovement-14-0.28.h5
Epoch 15/100
7550/7550 [==============================] - 285s 38ms/step - loss: 0.7637 - val_loss: 0.6771
val MRR 0.231219; val MAP 0.286605

Epoch 00015: map improved from 0.28184 to 0.28660, saving model to model_CuDNNimprovement-15-0.29.h5
Epoch 16/100
7550/7550 [==============================] - 289s 38ms/step - loss: 0.7282 - val_loss: 0.6785
val MRR 0.224287; val MAP 0.289936

Epoch 00016: map improved from 0.28660 to 0.28994, saving model to model_CuDNNimprovement-16-0.29.h5
Epoch 17/100
7550/7550 [==============================] - 282s 37ms/step - loss: 0.7327 - val_loss: 0.6784
val MRR 0.249992; val MAP 0.295078

Epoch 00017: map improved from 0.28994 to 0.29508, saving model to model_CuDNNimprovement-17-0.30.h5
Epoch 18/100
7550/7550 [==============================] - 291s 38ms/step - loss: 0.7218 - val_loss: 0.6776
val MRR 0.245949; val MAP 0.299753

Epoch 00018: map improved from 0.29508 to 0.29975, saving model to model_CuDNNimprovement-18-0.30.h5
Epoch 19/100
7550/7550 [==============================] - 289s 38ms/step - loss: 0.7016 - val_loss: 0.6809
val MRR 0.264497; val MAP 0.302482

Epoch 00019: map improved from 0.29975 to 0.30248, saving model to model_CuDNNimprovement-19-0.30.h5
Epoch 20/100
7550/7550 [==============================] - 295s 39ms/step - loss: 0.6915 - val_loss: 0.6806
val MRR 0.257459; val MAP 0.305733

Epoch 00020: map improved from 0.30248 to 0.30573, saving model to model_CuDNNimprovement-20-0.31.h5
Epoch 21/100
7550/7550 [==============================] - 294s 39ms/step - loss: 0.6818 - val_loss: 0.6808
val MRR 0.253520; val MAP 0.307901

Epoch 00021: map improved from 0.30573 to 0.30790, saving model to model_CuDNNimprovement-21-0.31.h5
Epoch 22/100
7550/7550 [==============================] - 290s 38ms/step - loss: 0.6859 - val_loss: 0.6828
val MRR 0.268164; val MAP 0.309076

Epoch 00022: map improved from 0.30790 to 0.30908, saving model to model_CuDNNimprovement-22-0.31.h5
Epoch 23/100
7550/7550 [==============================] - 294s 39ms/step - loss: 0.6715 - val_loss: 0.6913
val MRR 0.266488; val MAP 0.311562

Epoch 00023: map improved from 0.30908 to 0.31156, saving model to model_CuDNNimprovement-23-0.31.h5
Epoch 24/100
7550/7550 [==============================] - 294s 39ms/step - loss: 0.6691 - val_loss: 0.6954
val MRR 0.257890; val MAP 0.309803

Epoch 00024: map did not improve from 0.31156
Epoch 25/100
7550/7550 [==============================] - 293s 39ms/step - loss: 0.6677 - val_loss: 0.6996
val MRR 0.260114; val MAP 0.311616

Epoch 00025: map improved from 0.31156 to 0.31162, saving model to model_CuDNNimprovement-25-0.31.h5
Epoch 26/100
7550/7550 [==============================] - 292s 39ms/step - loss: 0.6664 - val_loss: 0.6990
val MRR 0.305768; val MAP 0.314523

Epoch 00026: map improved from 0.31162 to 0.31452, saving model to model_CuDNNimprovement-26-0.31.h5
Epoch 27/100
7550/7550 [==============================] - 291s 39ms/step - loss: 0.6484 - val_loss: 0.7081
val MRR 0.322054; val MAP 0.311950

Epoch 00027: map did not improve from 0.31452
Epoch 28/100
7550/7550 [==============================] - 295s 39ms/step - loss: 0.6478 - val_loss: 0.7112
val MRR 0.315341; val MAP 0.312349

Epoch 00028: map did not improve from 0.31452
Epoch 29/100
7550/7550 [==============================] - 298s 39ms/step - loss: 0.6364 - val_loss: 0.7162
val MRR 0.318244; val MAP 0.313006

Epoch 00029: map did not improve from 0.31452
Epoch 30/100
7550/7550 [==============================] - 299s 40ms/step - loss: 0.6285 - val_loss: 0.7260
val MRR 0.320456; val MAP 0.315602

Epoch 00030: map improved from 0.31452 to 0.31560, saving model to model_CuDNNimprovement-30-0.32.h5
Epoch 31/100
7550/7550 [==============================] - 298s 40ms/step - loss: 0.6280 - val_loss: 0.7304
val MRR 0.324686; val MAP 0.316347

Epoch 00031: map improved from 0.31560 to 0.31635, saving model to model_CuDNNimprovement-31-0.32.h5
Epoch 32/100
7550/7550 [==============================] - 300s 40ms/step - loss: 0.6245 - val_loss: 0.7230
val MRR 0.331442; val MAP 0.317408

Epoch 00032: map improved from 0.31635 to 0.31741, saving model to model_CuDNNimprovement-32-0.32.h5
Epoch 33/100
7550/7550 [==============================] - 300s 40ms/step - loss: 0.6272 - val_loss: 0.7066
val MRR 0.348502; val MAP 0.318273

Epoch 00033: map improved from 0.31741 to 0.31827, saving model to model_CuDNNimprovement-33-0.32.h5
Epoch 34/100
7550/7550 [==============================] - 304s 40ms/step - loss: 0.6181 - val_loss: 0.7077
val MRR 0.351330; val MAP 0.321044

Epoch 00034: map improved from 0.31827 to 0.32104, saving model to model_CuDNNimprovement-34-0.32.h5
Epoch 35/100
7550/7550 [==============================] - 299s 40ms/step - loss: 0.6159 - val_loss: 0.7159
val MRR 0.355347; val MAP 0.320323

Epoch 00035: map did not improve from 0.32104
Epoch 36/100
7550/7550 [==============================] - 298s 39ms/step - loss: 0.6110 - val_loss: 0.7163
val MRR 0.356226; val MAP 0.318662

Epoch 00036: map did not improve from 0.32104
Epoch 37/100
7550/7550 [==============================] - 304s 40ms/step - loss: 0.6162 - val_loss: 0.7114
val MRR 0.369559; val MAP 0.319109

Epoch 00037: map did not improve from 0.32104
Epoch 38/100
7550/7550 [==============================] - 296s 39ms/step - loss: 0.6053 - val_loss: 0.7189
val MRR 0.388170; val MAP 0.318679

Epoch 00038: map did not improve from 0.32104
Epoch 39/100
7550/7550 [==============================] - 292s 39ms/step - loss: 0.5944 - val_loss: 0.7390
val MRR 0.361489; val MAP 0.319710

Epoch 00039: map did not improve from 0.32104
Epoch 40/100
7550/7550 [==============================] - 299s 40ms/step - loss: 0.5998 - val_loss: 0.7530
val MRR 0.437045; val MAP 0.320963

Epoch 00040: map did not improve from 0.32104
Epoch 41/100
7550/7550 [==============================] - 293s 39ms/step - loss: 0.5986 - val_loss: 0.7395
val MRR 0.386782; val MAP 0.320530

Epoch 00041: map did not improve from 0.32104
Epoch 42/100
7550/7550 [==============================] - 294s 39ms/step - loss: 0.5917 - val_loss: 0.7266
val MRR 0.398426; val MAP 0.322130

Epoch 00042: map improved from 0.32104 to 0.32213, saving model to model_CuDNNimprovement-42-0.32.h5
Epoch 43/100
7550/7550 [==============================] - 286s 38ms/step - loss: 0.5918 - val_loss: 0.7272
val MRR 0.389127; val MAP 0.319449

Epoch 00043: map did not improve from 0.32213
Epoch 44/100
7550/7550 [==============================] - 274s 36ms/step - loss: 0.5858 - val_loss: 0.7369
val MRR 0.412168; val MAP 0.319690

Epoch 00044: map did not improve from 0.32213
Epoch 45/100
7550/7550 [==============================] - 266s 35ms/step - loss: 0.5846 - val_loss: 0.7220
val MRR 0.341766; val MAP 0.319210

Epoch 00045: map did not improve from 0.32213
Epoch 46/100
7550/7550 [==============================] - 262s 35ms/step - loss: 0.5867 - val_loss: 0.7208
val MRR 0.301124; val MAP 0.319203

Epoch 00046: map did not improve from 0.32213
Epoch 47/100
7550/7550 [==============================] - 268s 35ms/step - loss: 0.5821 - val_loss: 0.7352
val MRR 0.434184; val MAP 0.321894

Epoch 00047: map did not improve from 0.32213
Epoch 48/100
7550/7550 [==============================] - 264s 35ms/step - loss: 0.5771 - val_loss: 0.7280
val MRR 0.389510; val MAP 0.320993

Epoch 00048: map did not improve from 0.32213
Epoch 49/100
7550/7550 [==============================] - 263s 35ms/step - loss: 0.5767 - val_loss: 0.7235
val MRR 0.366118; val MAP 0.321190

Epoch 00049: map did not improve from 0.32213
Epoch 50/100
7550/7550 [==============================] - 252s 33ms/step - loss: 0.5716 - val_loss: 0.7346
val MRR 0.368466; val MAP 0.321508

Epoch 00050: map did not improve from 0.32213
Epoch 51/100
7550/7550 [==============================] - 252s 33ms/step - loss: 0.5669 - val_loss: 0.7231
val MRR 0.384716; val MAP 0.322157

Epoch 00051: map improved from 0.32213 to 0.32216, saving model to model_CuDNNimprovement-51-0.32.h5
Epoch 52/100
7550/7550 [==============================] - 254s 34ms/step - loss: 0.5634 - val_loss: 0.7092
val MRR 0.351374; val MAP 0.317269

Epoch 00052: map did not improve from 0.32216
Epoch 53/100
7550/7550 [==============================] - 257s 34ms/step - loss: 0.5607 - val_loss: 0.7020
val MRR 0.356007; val MAP 0.316692

Epoch 00053: map did not improve from 0.32216
Epoch 54/100
7550/7550 [==============================] - 259s 34ms/step - loss: 0.5621 - val_loss: 0.7039
val MRR 0.370268; val MAP 0.315723

Epoch 00054: map did not improve from 0.32216
Epoch 55/100
7550/7550 [==============================] - 252s 33ms/step - loss: 0.5649 - val_loss: 0.7128
val MRR 0.365065; val MAP 0.318055

Epoch 00055: map did not improve from 0.32216
Epoch 56/100
7550/7550 [==============================] - 261s 35ms/step - loss: 0.5563 - val_loss: 0.7192
val MRR 0.371671; val MAP 0.319085

Epoch 00056: map did not improve from 0.32216
Epoch 57/100
7550/7550 [==============================] - 257s 34ms/step - loss: 0.5600 - val_loss: 0.7234
val MRR 0.317703; val MAP 0.317767

Epoch 00057: map did not improve from 0.32216
Epoch 58/100
7550/7550 [==============================] - 252s 33ms/step - loss: 0.5539 - val_loss: 0.7200
val MRR 0.368168; val MAP 0.315899

Epoch 00058: map did not improve from 0.32216
Epoch 59/100
7550/7550 [==============================] - 257s 34ms/step - loss: 0.5563 - val_loss: 0.7154
val MRR 0.369921; val MAP 0.314359

Epoch 00059: map did not improve from 0.32216
Epoch 60/100
7550/7550 [==============================] - 255s 34ms/step - loss: 0.5498 - val_loss: 0.7152
val MRR 0.364683; val MAP 0.315648

Epoch 00060: map did not improve from 0.32216
Epoch 61/100
7550/7550 [==============================] - 256s 34ms/step - loss: 0.5449 - val_loss: 0.7252
val MRR 0.368571; val MAP 0.316799

Epoch 00061: map did not improve from 0.32216
Epoch 62/100
7550/7550 [==============================] - 258s 34ms/step - loss: 0.5438 - val_loss: 0.7201
val MRR 0.371111; val MAP 0.315111

Epoch 00062: map did not improve from 0.32216
Epoch 63/100
7550/7550 [==============================] - 253s 33ms/step - loss: 0.5437 - val_loss: 0.6938
val MRR 0.360083; val MAP 0.310370

Epoch 00063: map did not improve from 0.32216
Epoch 64/100
7550/7550 [==============================] - 251s 33ms/step - loss: 0.5478 - val_loss: 0.7025
val MRR 0.364103; val MAP 0.311512

Epoch 00064: map did not improve from 0.32216
Epoch 65/100
7550/7550 [==============================] - 260s 34ms/step - loss: 0.5401 - val_loss: 0.7020
val MRR 0.345126; val MAP 0.311661

Epoch 00065: map did not improve from 0.32216
Epoch 66/100
7550/7550 [==============================] - 280s 37ms/step - loss: 0.5383 - val_loss: 0.7139
val MRR 0.345224; val MAP 0.312019

Epoch 00066: map did not improve from 0.32216
Epoch 67/100
7550/7550 [==============================] - 281s 37ms/step - loss: 0.5329 - val_loss: 0.7110
val MRR 0.349216; val MAP 0.308471

Epoch 00067: map did not improve from 0.32216
Epoch 68/100
7550/7550 [==============================] - 278s 37ms/step - loss: 0.5302 - val_loss: 0.7160
val MRR 0.373790; val MAP 0.309764

Epoch 00068: map did not improve from 0.32216
Epoch 69/100
7550/7550 [==============================] - 274s 36ms/step - loss: 0.5229 - val_loss: 0.7149
val MRR 0.345042; val MAP 0.307766

Epoch 00069: map did not improve from 0.32216
Epoch 70/100
7550/7550 [==============================] - 273s 36ms/step - loss: 0.5329 - val_loss: 0.7139
val MRR 0.343322; val MAP 0.303934

Epoch 00070: map did not improve from 0.32216
Epoch 71/100
7550/7550 [==============================] - 268s 35ms/step - loss: 0.5265 - val_loss: 0.7051
val MRR 0.361411; val MAP 0.308135

Epoch 00071: map did not improve from 0.32216
Epoch 72/100
7550/7550 [==============================] - 259s 34ms/step - loss: 0.5281 - val_loss: 0.6972
val MRR 0.371230; val MAP 0.308392

Epoch 00072: map did not improve from 0.32216
Epoch 73/100
7550/7550 [==============================] - 258s 34ms/step - loss: 0.5210 - val_loss: 0.6927
val MRR 0.385821; val MAP 0.303606

Epoch 00073: map did not improve from 0.32216
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
question_base (InputLayer)      (None, 150)          0
__________________________________________________________________________________________________
answer (InputLayer)             (None, 150)          0
__________________________________________________________________________________________________
bi_lstm (Model)                 (None, 1)            2639729     question_base[0][0]
                                                                 answer[0][0]
==================================================================================================
Total params: 2,639,729
Trainable params: 2,638,129
Non-trainable params: 1,600

PATH_DATA_TRAIN = '/content/driver/My Drive/DATN/train.txt'
PATH_DATA_DEV = '/content/driver/My Drive/DATN/dev.txt'
PATH_DATA_TEST = '/content/driver/My Drive/DATN/test_lstm.txt'
PATH_WORD_VECTOR = '/content/driver/My Drive/DATN/vectors.txt'
PATH_VOCAB = '/content/driver/My Drive/DATN/vocab_all.txt'

wordvector_dims = 200

qa_embedding = Embedding(
    input_dim=vocab_size + 1,
    input_length=None,
    output_dim=weights.shape[1],
    mask_zero=True,
    weights=[weights])

bi_lstm1 = Bidirectional(
        LSTM(units=200, return_sequences=False))
bi_lstm2 = Bidirectional(
    LSTM(units=200, return_sequences=False))

training_model.fit(
    [questions_origin, question_related],
    Y,
    epochs=100,
    batch_size=60,
    validation_data=([q_origin_dev_eb, q_related_dev_eb], l_dev),
    verbose=1,
    callbacks=callback_list
)

MAP:  0.4821253022664143
MRR:  0.6776811594202898
